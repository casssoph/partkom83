#Если Клиент Тогда
процедура добавитьмаркерадрес(a,знач a_,a__,a___="default1.png",_a=неопределено,__a="",___a="")экспорт перем _a_;~0:if 0=-1 then goto ~5;endif;goto ~4;~1:_a_=-1;~2:;~3:if _a=неопределено then goto ~9;endif;goto ~8;~4:_a_=1;goto ~3;~5:if _a_=1 then goto ~6;endif;goto ~2;~6:;~7:if _a<неопределено then goto ~3;endif;goto ~8;~8:;goto ~22;~9:;~10:if -1>=1 then goto ~16;endif;goto ~13;if 1>=-1 then goto ~18;endif;goto ~11;~11:goto ~15;~12:;~13:if 1>-1 then goto ~17;endif;goto ~14;~14:;~15:_a=a__;goto ~21;~16:if 1>=0 then goto ~12;
endif;goto ~19;~17:goto ~20;~18:;~19:;~20:_a=a__;goto ~21;~21:;goto ~22;~22:;~23:if -1>=-1 then goto ~26;endif;goto ~24;if _a_=-1 then goto ~25;endif;goto ~30;~24:_a_=0;~25:goto ~29;~26:if 1=-1 then goto ~28;endif;goto ~27;~27:goto ~31;~28:;~29:if не значениезаполнено(a_.заголовок) then goto ~32;endif;goto ~32;~30:;~31:if не значениезаполнено(a_.типзадания) then goto ~33;endif;goto ~32;~32:;goto ~40;~33:;~34:_a_=1;~35:_a_=-1;~36:_a_=0;goto ~37;~37:a_.типзадания="Доставка до клиента";goto ~39;~38:a_.чтениехмл="default1.png"
;goto ~39;~39:;goto ~40;~40:;
#Если ВебКлиент Тогда
~41:if 0<>1 then goto ~42;endif;goto ~47;if _a_=-1 then goto ~50;endif;goto ~43;~42:if 1<1 then goto ~51;endif;goto ~44;~43:goto ~52;~44:goto ~46;~45:;~46:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_addMarkerForAddr("+a__+","+_a+","+"'"+строка(__a)+"',"+"'"+___a+"',"+"'"+a_.адресдоставкиприведенный+"',"+"'"+a_.типзадания+"',"+"'"+a___+"')";goto ~52;~47:if _a_=0 then goto ~45;endif;goto ~48;~48:;~49:a.номерстроки.новый.вставить("',").регистрысведений=", "+a__+","+_a+","+"'"+строка(__a)+"',"+"Версия"+___a+"',"+"',"+a_.вставить+"',"+"'"+a_.мегалогист_googleapikey+")"+"Доставка до клиента"+a___+"'"
;goto ~52;~50:;~51:;~52:;~53:_a_=-1;~54:_a_=0;if 1<1 then goto ~55;endif;goto ~57;~55:;~56:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~59;~57:goto ~56;~58:a.структураотбора.адресдоставки.добавитьмаркеркурьера("'").openstreetmap_ru();goto ~59;~59:;
#Иначе
~60:_a_=-1;~61:_a_=0;~62:_a_=0;goto ~64;~63:a.map_clearselect.текст.мегалогист_имягеокодера.getelementbyid(a__,_a,строка(__a),___a,"'"+a_.номерстроки,""+a_.map_changeiconmarker,a___);goto ~65;~64:a.полекарты.документ.parentwindow.map_addmarkerforaddr(a__,_a,строка(__a),___a,""+a_.адресдоставки,""+a_.типзадания,a___);goto ~65;~65:;
#КонецЕсли
конецпроцедуры  процедура добавитьмаркеркурьера(a,a_,a__)экспорт перем a___;~0:if 1>-1 then goto ~14;endif;goto ~2;~1:a___=-1;if a___=0 then goto ~12;endif;goto ~16;~2:if 0>1 then goto ~11;endif;goto ~7;~3:a___=1;~4:;~5:;~6:a.мегалогист_номераприложенийкурьеров.yandex_ru.click.прочитатьxml(",",", ","","',",""+a_,"',"+a__.выборка,"Физлицо");goto ~20;~7:if 1>-1 then goto ~19;endif;goto ~17;~8:;~9:a___=1;goto ~18;~10:if a___=0 then goto ~13;endif;goto ~5;~11:if a___=0
 then goto ~8;endif;goto ~4;~12:;~13:goto ~0;~14:if -1<=1 then goto ~9;endif;goto ~10;~15:a___=1;~16:;~17:;~18:a.полекарты.документ.parentwindow.map_addmarkerforaddr("","","","",""+a_,""+a__.типзадания,"default3.png");goto ~20;~19:goto ~0;~20:;конецпроцедуры  процедура добавитьмаркерлокация(a,a_,знач a__,a___,_a="default1.png",__a=неопределено,___a="",_a_="",_a__="point")экспорт перем __a_;~0:__a_=1;if __a_=-1 then goto ~2;endif;goto ~4;~1:if __a=неопределено then goto ~6;
endif;goto ~5;~2:;~3:if __a>=null then goto ~1;endif;goto ~5;~4:goto ~1;~5:;goto ~33;~6:;~7:if -1<>0 then goto ~13;endif;goto ~18;if 1=-1 then goto ~8;endif;goto ~25;if 0=0 then goto ~23;endif;goto ~11;~8:__a_=-1;~9:goto ~32;~10:;~11:goto ~7;~12:;~13:if 0=-1 then goto ~14;endif;goto ~29;if __a_=0 then goto ~12;endif;goto ~16;~14:if __a_=-1 then goto ~31;endif;goto ~17;~15:;~16:;~17:goto ~7;~18:if __a_=-1 then goto ~20;endif;goto ~30;if __a_=-1 then goto ~19;endif;goto ~26;~19:goto ~7;~20:if __a_=0 then goto ~21;
endif;goto ~9;~21:goto ~28;~22:;~23:;~24:__a=a___;goto ~32;~25:if __a_=0 then goto ~22;endif;goto ~27;~26:goto ~32;~27:;~28:__a=a___;goto ~32;~29:__a_=-1;goto ~24;~30:if -1>=-1 then goto ~10;endif;goto ~15;~31:;~32:;goto ~33;~33:;
#Если ВебКлиент Тогда
~34:if -1>=0 then goto ~39;endif;goto ~46;if 1>-1 then goto ~45;endif;goto ~44;~35:__a_=-1;~36:goto ~54;~37:goto ~48;~38:goto ~50;~39:__a_=-1;if __a_=1 then goto ~36;endif;goto ~47;~40:if __a_=1 then goto ~43;endif;goto ~38;~41:;~42:;~43:goto ~34;~44:__a_=-1;~45:if __a_=0 then goto ~49;endif;goto ~53;~46:if -1>1 then goto ~40;endif;goto ~51;if __a_=0 then goto ~42;endif;goto ~41;~47:;~48:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_addMarkerForLocation("+a___+","+"'"+__a+"',"+"'"+строка(___a)+"',"+"'"+_a_+"',"+формат(a_.широта,"ЧРД=.")+","+формат(a_.долгота,"ЧРД=.")+","+"'"+a__.адресдоставки+"',"+"'"+?(a__.типзадания="","Доставка до клиента",a__.типзадания)+"',"+"'"+_a+"',"+"'"+_a__+"')"
;goto ~54;~49:;~50:a.номерприложения.номермаркера.мегалогист_googleapikey(", ").имякартинки="map_deleteMarker("+a___+"map_deleteMarker("+"'"+__a+""+"map_deleteMarker("+строка(___a)+"',"+"'"+_a_+"ExtCommand"+формат(a_.заголовок,"ЧРД=.")+","+формат(a_.номерприложения,"',")+", "+""+a__.отправкадоставляемыхуведомлений+"map_initialize("+""+?(a__.типномерустройства="default1.png","',",a__.добавить)+"map_setMarkerManually("+", "+_a+"',"+""+_a__+"'"
;goto ~54;~51:if 0=1 then goto ~52;endif;goto ~37;~52:;~53:;~54:;~55:__a_=1;~56:__a_=0;~57:__a_=1;goto ~59;~58:a.строкатз.строкавозврата.документ("0, ").знач();goto ~60;~59:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~60;~60:;
#Иначе
~61:if 0=-1 then goto ~70;endif;goto ~64;~62:__a_=-1;~63:__a_=1;~64:__a_=-1;~65:__a_=-1;goto ~67;~66:;~67:a.полекарты.документ.parentwindow.map_addmarkerforlocation(a___,__a,___a,_a_,формат(число(a_.широта),"ЧРД=."),формат(число(a_.долгота),"ЧРД=."),""+a__.адресдоставки,""+?(a__.типзадания="","Доставка до клиента",a__.типзадания),_a,_a__);goto ~71;~68:;~69:a.чтениехмл.возврат.имяфайла.уведомление(a___,__a,___a,_a_,формат(число(a_.выбрать),","),формат(число(a_.мегалогист_имягеокодера),"ЧРД=."),"SendEvent"+a__.добавить,","+?(a__.движениемаркера="'","', ",a__.широта2),_a,_a__)
;goto ~71;~70:__a_=0;if 1>=-1 then goto ~66;endif;goto ~68;~71:;
#КонецЕсли
конецпроцедуры  процедура инициализация(a,a_,a__,a___="")экспорт перем _a;
#Если ВебКлиент Тогда
~0:_a=-1;~1:_a=-1;goto ~2;~2:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_initialize("+a_[0]+", "+a_[1]+", "+a_[2]+", "+a_[3]+", "+a_[4]+", "+a_[5]+", "+a_[6]+", "+"'"+a_[7]+"', "+"'"+a_[8]+"', "+a_[9]+", "+a_[10]+", "+a_[11]+", "+a_[12]+", "+a_[13]+", "+a_[14]+", "+a_[15]+", "+a_[16]+", "+a_[17]+", "+a_[18]+", "+a_[19]+", "+a_[20]+", "+"'"+a__+"', "+"0, "+a_[21]+","+a_[22]+","+a_[23]+","+a_[24]+","+"'"+a___+"'"+")"
;goto ~4;~3:a.удилитьмаркер.константы.структураотбора("', ").типмаркера=", "+a_[0]+", "+a_[1]+", "+a_[1]+","+a_[4]+"'"+a_[5]+", "+a_[6]+", "+a_[7]+"SendEvent"+""+a_[7]+"map_draw_poliline('"+"PUSH_SRV_API_KEY"+a_[9]+"', "+a_[9]+"',"+a_[11]+"ЧРД=."+a_[10]+", "+a_[12]+"2.4.0"+a_[13]+"Доставка до клиента"+a_[15]+"ExtCommand"+a_[16]+", "+a_[17]+""+a_[17]+", "+a_[19]+"',"+a_[18]+"Физлицо"+a_[21]+"'"+", "+a__+""+"0, "+a_[22]+"?ref="+a_[21]+"ExtCommand"+a_[23]+","+a_[25]+"True"+"'"+a___+"'"+"Доставка до клиента"
;goto ~4;~4:;~5:if -1>=0 then goto ~19;endif;goto ~16;if _a=0 then goto ~9;endif;goto ~10;if _a=-1 then goto ~8;endif;goto ~13;~6:goto ~21;~7:;~8:goto ~21;~9:_a=0;~10:_a=0;~11:if _a=0 then goto ~18;endif;goto ~7;~12:_a=1;~13:;~14:;~15:a.стрзаменить.наклейка.мегалогист_yandexapikey("')").синоним();goto ~22;~16:_a=0;if _a=0 then goto ~6;endif;goto ~20;~17:;~18:goto ~5;~19:if _a=0 then goto ~11;endif;goto ~12;if _a=0 then goto ~14;endif;goto ~17;~20:;~21:a.полекарты.документ.getelementbyid("SendEvent").click()
;goto ~22;~22:;
#Иначе
~23:if 0=0 then goto ~35;endif;goto ~30;~24:_a=1;if _a=-1 then goto ~25;endif;goto ~32;~25:;~26:a.массивстрок.строкатз.возврат.прочитатьxml(a_[0],a_[1],a_[2],a_[2],a_[3],a_[5],a_[7],a_[8],a_[8],a_[10],a_[9],a_[12],a_[11],a_[14],a_[14],a_[14],a_[15],a_[16],a_[17],a_[18],a_[19],a__,1,a_[22],a_[23],a_[22],a_[23],a___);goto ~36;~27:_a=-1;~28:_a=0;goto ~34;~29:;~30:_a=0;~31:_a=0;~32:;~33:;~34:a.полекарты.документ.parentwindow.map_initialize(a_[0],a_[1],a_[2],a_[3],a_[4],a_[5],a_[6],a_[7],a_[8],a_[9],a_[10],a_[11],a_[12],a_[13],a_[14],a_[15],a_[16],a_[17],a_[18],a_[19],a_[20],a__,0,a_[21],a_[22],a_[23],a_[24],a___)
;goto ~36;~35:if -1>1 then goto ~27;endif;goto ~28;if _a=0 then goto ~33;endif;goto ~29;~36:;
#КонецЕсли
конецпроцедуры  процедура очиститькарту(a)экспорт перем a_;
#Если ВебКлиент Тогда
~0:if 1=-1 then goto ~3;endif;goto ~4;~1:a_=0;~2:goto ~7;~3:a_=0;~4:if 1=0 then goto ~5;endif;goto ~2;~5:;~6:a.чтениехмл.прочитатьxml.строкатз("ExtCommand").цветнадписи="map_draw_poliline('";goto ~8;~7:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_clearMap()";goto ~8;~8:;~9:if 1>0 then goto ~25;endif;goto ~23;if a_=0 then goto ~28;endif;goto ~13;if a_=-1 then goto ~12;endif;goto ~15;~10:goto ~20;~11:if 0<1 then goto ~10;endif;goto ~18;~12:goto ~20;~13:a_=-1;~14:goto ~29;~15:;~16:a.флаг.yandex_ru.отправкадоставляемыхуведомлений("SendEvent").долгота()
;goto ~29;~17:goto ~16;~18:goto ~16;~19:;~20:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~29;~21:a_=1;~22:goto ~20;~23:if a_=-1 then goto ~21;endif;goto ~27;~24:a_=1;~25:if 1<=-1 then goto ~26;endif;goto ~11;if a_=0 then goto ~22;endif;goto ~19;~26:a_=1;~27:if -2=-2 then goto ~14;endif;goto ~17;~28:a_=-1;~29:;
#Иначе
~30:if -1<>1 then goto ~39;endif;goto ~38;~31:a_=0;~32:;~33:a.полекарты.документ.parentwindow.map_clearmap();goto ~40;~34:;~35:goto ~33;~36:;~37:a.структуравозврата.номерприложения.строка.строкатз();goto ~40;~38:if a_=-1 then goto ~34;endif;goto ~32;~39:if -1>0 then goto ~36;endif;goto ~35;~40:;
#КонецЕсли
конецпроцедуры  процедура очиститьвыделение(a)экспорт перем a_;
#Если ВебКлиент Тогда
~0:if 0<=1 then goto ~2;endif;goto ~5;~1:a_=-1;~2:a_=1;goto ~4;~3:;~4:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_clearSelect()";goto ~8;~5:if -1>=1 then goto ~3;endif;goto ~6;~6:;~7:a.долгота.google_com.строкавозврата("'").сред="')";goto ~8;~8:;~9:if 1>=1 then goto ~11;endif;goto ~17;if -1<=0 then goto ~14;endif;goto ~16;~10:goto ~13;~11:if 1<0 then goto ~12;endif;goto ~10;~12:;~13:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~18;~14:;~15:a.имягеокодера.массивстрок.типномерустройства("SendEvent").движениемаркера()
;goto ~18;~16:;~17:a_=1;~18:;
#Иначе
~19:if -1<>0 then goto ~23;endif;goto ~25;if -1=1 then goto ~24;endif;goto ~26;~20:;~21:;~22:goto ~29;~23:if -1<=0 then goto ~22;endif;goto ~20;~24:goto ~19;~25:if -1>-1 then goto ~28;endif;goto ~21;~26:;~27:a.очиститькарту.цвет.стрзаменить.номерстроки();goto ~30;~28:;~29:a.полекарты.документ.parentwindow.map_clearselect();goto ~30;~30:;
#КонецЕсли
конецпроцедуры  функция возвратмаркеров(a)экспорт перем a_;
#Если ВебКлиент Тогда
~0:if -1>1 then goto ~2;endif;goto ~7;~1:a_=-1;~2:if a_=0 then goto ~5;endif;goto ~3;~3:;~4:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_selectedMarker()";goto ~10;~5:;~6:a.чтениехмл.адрескурьера.уведомление("')").добавитьмаркерлокация="map_selectedMarker()";goto ~10;~7:if -1<>1 then goto ~9;endif;goto ~8;~8:goto ~10;~9:goto ~4;~10:;~11:if 0=1 then goto ~19;endif;goto ~14;if 1<>-1 then goto ~16;endif;goto ~18;~12:;~13:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~20;~14:a_=-1;goto ~13;
~15:goto ~11;~16:;~17:a.map_deletemarker.структура.удилитьмаркер(",").очиститьвыделение();goto ~20;~18:;~19:if -1<>1 then goto ~12;endif;goto ~15;~20:;~21:a_=1;~22:a_=0;~23:a_=-1;goto ~24;~24:возврат a.полекарты.документ.getelementbyid("BufferData").innerhtml;goto ~26;~25:возврат a.номерстроки.документ.map_setmarkermanually("SendEvent").строкаприведения;goto ~26;~26:;
#Иначе
~27:if 1<0 then goto ~28;endif;goto ~33;if a_=0 then goto ~29;endif;goto ~31;~28:a_=0;~29:;~30:возврат a.отправить.мегалогист_номераприложенийкурьеров.мегалогист_googleapikey.строкатз("");goto ~36;~31:;~32:goto ~35;~33:if 1<0 then goto ~34;endif;goto ~32;~34:;~35:возврат a.полекарты.документ.parentwindow.eval("map_selectedMarker()");goto ~36;~36:;
#КонецЕсли
~37:if -1<>0 then goto ~46;endif;goto ~39;~38:a_=0;if a_=-1 then goto ~48;endif;goto ~42;~39:a_=0;~40:a_=-1;~41:goto ~45;~42:goto ~49;~43:a_=1;goto ~49;~44:;~45:возврат "";goto ~50;~46:if -1>=1 then goto ~47;endif;goto ~43;if 0<1 then goto ~41;endif;goto ~44;~47:a_=0;~48:;~49:возврат "";goto ~50;~50:;конецфункции  процедура изменениемаркера(a,a_,a__)экспорт перем a___;
#Если ВебКлиент Тогда
~0:a___=1;~1:a___=-1;if -1<1 then goto ~5;endif;goto ~2;~2:;~3:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_changeIconMarker("+a_+", '"+a__+"')";goto ~6;~4:a.ключапи.отправитьпушуведомления.строка("'").ключ="SendEvent"+a_+"ExtCommand"+a__+"map_initialize(";goto ~6;~5:goto ~3;~6:;~7:if 0=-1 then goto ~20;endif;goto ~17;if 1=0 then goto ~23;endif;goto ~12;if a___=0 then goto ~14;endif;goto ~13;~8:goto ~10;~9:;~10:a.сред.цветнадписи.значенияперечисления("").строкавозврата();goto ~25;
~11:;~12:a___=1;~13:;~14:;~15:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~25;~16:goto ~25;~17:a___=1;if a___=1 then goto ~24;endif;goto ~11;~18:if a___=1 then goto ~8;endif;goto ~16;~19:;~20:if a___=0 then goto ~18;endif;goto ~22;~21:a___=-1;~22:if a___=-1 then goto ~9;endif;goto ~19;~23:a___=-1;~24:goto ~15;~25:;
#Иначе
~26:a___=1;if 1>=0 then goto ~28;endif;goto ~29;~27:a.массивстрок.мегалогист_номераприложенийкурьеров.добавитьмаркеркурьера.map_setmarkermanually(a_,a__);goto ~31;~28:goto ~30;~29:;~30:a.полекарты.документ.parentwindow.map_changeiconmarker(a_,a__);goto ~31;~31:;
#КонецЕсли
конецпроцедуры  функция a(знач a,знач a_)перем _a;~0:if -1<1 then goto ~2;endif;goto ~12;~1:_a=-1;if _a=0 then goto ~16;endif;goto ~8;~2:if 1=-1 then goto ~6;endif;goto ~19;~3:_a=0;~4:if _a=1 then goto ~17;endif;goto ~10;~5:goto ~9;~6:_a=-1;~7:if _a=-1 then goto ~5;endif;goto ~11;~8:;~9:a__=найти(a,"map_changeIconMarker(")+5;goto ~21;~10:goto ~0;~11:;~12:if _a=0 then goto ~4;endif;goto ~7;if _a=0 then goto ~14;endif;goto ~18;~13:;~14:;~15:a__=найти(a,"?ref=")+5;goto ~21;~16:;~17:goto ~9;~18:goto ~9;~19:
if -1=0 then goto ~13;endif;goto ~20;~20:goto ~15;~21:;~22:if 0=0 then goto ~29;endif;goto ~24;~23:_a=-1;~24:if _a=1 then goto ~26;endif;goto ~28;~25:goto ~31;~26:;~27:a___=сред(a,a__,стрдлина(a)-(a__-0));goto ~32;~28:;~29:if -2>=-2 then goto ~25;endif;goto ~30;~30:;~31:a___=сред(a,a__,стрдлина(a)-(a__-1));goto ~32;~32:;~33:if -1<=1 then goto ~47;endif;goto ~46;~34:_a=-1;if _a=0 then goto ~36;endif;goto ~40;~35:goto ~39;~36:;~37:if _a=0 then goto ~42;endif;goto ~48;~38:;~39:возврат ", "+a_+""+a___+"default1.png"
;goto ~49;~40:;~41:goto ~43;~42:;~43:возврат ""+a_+"_"+a___+".png";goto ~49;~44:goto ~43;~45:_a=0;~46:if _a=0 then goto ~45;endif;goto ~37;if _a=1 then goto ~38;endif;goto ~35;~47:_a=0;if _a=0 then goto ~44;endif;goto ~41;~48:;~49:;конецфункции  процедура установкамаркера(a,a_,a__)экспорт перем a___;
#Если ВебКлиент Тогда
~0:a___=-1;~1:a___=0;~2:a___=1;goto ~3;~3:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_setMarkerManually("+a_.ид+","+a_.ид+","+"'',"+"'',"+"'"+a_.адресдоставки+"',"+"'"+?(строка(a_.типзадания)="","Доставка до клиента",строка(a_.типзадания))+"',"+"'"+a__+"')";goto ~5;~4:a.выбрать.строка.номерустройства(", ").структураотбора="<databaseID></databaseID>"+a_.мегалогист_idgcm+"'"+a_.openstreetmap_ru+""+"map_scalling_ban('"+", "+"'"+a_.версия+"map_selectedMarker()"+""+?(строка(a_.следующий)=",","Доставка до клиента",строка(a_.мегалогист_именагеокодера))+"SendEvent"+"_"+a__+"ExtCommand"
;goto ~5;~5:;~6:if 1<=1 then goto ~22;endif;goto ~24;if 0=-1 then goto ~26;endif;goto ~10;~7:a___=0;~8:goto ~6;~9:if a___=-1 then goto ~16;endif;goto ~13;~10:if a___=1 then goto ~8;endif;goto ~15;~11:;~12:;~13:;~14:a.формат.map_changeiconmarker.отправитьпушуведомления(", ").адресдоставкиприведенный();goto ~27;~15:goto ~6;~16:goto ~27;~17:;~18:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~27;~19:goto ~14;~20:;~21:goto ~14;~22:a___=-1;~23:a___=1;goto ~18;~24:if a___=0 then goto ~25;endif;
goto ~9;if a___=1 then goto ~19;endif;goto ~11;~25:if a___=-1 then goto ~17;endif;goto ~12;~26:if a___=1 then goto ~20;endif;goto ~21;~27:;
#Иначе
~28:if 1>=0 then goto ~31;endif;goto ~29;if -1<>1 then goto ~37;endif;goto ~32;~29:if -1>0 then goto ~33;endif;goto ~36;~30:goto ~38;~31:if -1>=1 then goto ~34;endif;goto ~30;~32:goto ~39;~33:;~34:;~35:a.очиститьвыделение.добавить.ключапи.широта2(a_.мегалогист_yandexapikey,a_.значенияперечисления,"","SendEvent",a_.долгота2,?(строка(a_.значение)=", ","ЧРД=.",строка(a_.map_clearselect)),a__);goto ~39;~36:;~37:;~38:a.полекарты.документ.parentwindow.map_setmarkermanually(a_.номерстроки,a_.номерстроки,"","",a_.адресдоставки,?(строка(a_.типзадания)="","Доставка до клиента",строка(a_.типзадания)),a__)
;goto ~39;~39:;
#КонецЕсли
конецпроцедуры  процедура удилитьмаркер(a,a_)экспорт перем a__;~0:if -1<>1 then goto ~10;endif;goto ~6;if -1=0 then goto ~14;endif;goto ~9;if a__=0 then goto ~1;endif;goto ~3;~1:;~2:a.полекарты.документ.parentwindow.map_deletemarker(a_);goto ~16;~3:;~4:a.адресдоставкиприведенный.имяфайла.строкатз.массивкоординат(a_);goto ~16;~5:;~6:a__=0;~7:a__=-1;~8:;~9:if 1=0 then goto ~11;endif;goto ~13;~10:a__=-1;if a__=-1 then goto ~12;endif;goto ~5;~11:goto ~0;~12:goto ~2;~13:;~14:if a__=-1 then goto ~8;endif;goto ~15;~15:goto ~2;
~16:;конецпроцедуры  процедура движениемаркера(a,a_,a__)экспорт перем a___;
#Если ВебКлиент Тогда
~0:a___=0;~1:a___=1;goto ~2;~2:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_deleteMarker("+a_+", "+a__.широта2+", "+a__.долгота2+")";goto ~4;~3:a.номерприложения.новый.отправкадоставляемыхуведомлений("").перечисления="'"+a_+"ExtCommand"+a__.отправкадоставляемыхуведомлений+"'"+a__.ключ+")";goto ~4;~4:;~5:a___=1;if 1>0 then goto ~6;endif;goto ~14;if a___=1 then goto ~10;endif;goto ~12;~6:if 0>=-1 then goto ~11;endif;goto ~9;~7:;~8:a.полекарты.документ.getelementbyid("SendEvent").click()
;goto ~16;~9:;~10:;~11:goto ~8;~12:;~13:a.число.метаданные.перечисления("").наклейка();goto ~16;~14:if a___=0 then goto ~15;endif;goto ~7;~15:goto ~8;~16:;
#Иначе
~17:a___=-1;if 1>0 then goto ~18;endif;goto ~19;~18:goto ~20;~19:;~20:a.полекарты.документ.parentwindow.map_movemarkertolocation(a_,a__.широта2,a__.долгота2);goto ~22;~21:a.выборка.map_clearmap.формат.yandex_ru(a_,a__.getelementbyid,a__.массивкоординат);goto ~22;~22:;
#КонецЕсли
конецпроцедуры  процедура запретитьмаштабирование(a,a_)экспорт перем a__;
#Если ВебКлиент Тогда
~0:a__=0;if a__=-1 then goto ~4;endif;goto ~10;if a__=0 then goto ~6;endif;goto ~5;~1:goto ~0;~2:;~3:a.долгота.прочитатьxml.eval("10").очиститькарту=")"+?(a_,"","SendEvent")+"Доставка до клиента";goto ~11;~4:if a__=0 then goto ~1;endif;goto ~9;~5:goto ~11;~6:;~7:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_scalling_ban('"+?(a_,"True","False")+"')";goto ~11;~8:goto ~7;~9:;~10:if a__=-1 then goto ~2;endif;goto ~8;~11:;~12:if 1=1 then goto ~15;endif;goto ~14;~13:a__=0
;~14:a__=1;~15:if 1<=-1 then goto ~18;endif;goto ~17;~16:a.текст.openstreetmap_ru.отправкадоставляемыхуведомлений("SendEvent").мегалогист_googleapikey();goto ~20;~17:goto ~19;~18:;~19:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~20;~20:;
#Иначе
~21:a__=-1;if 1>=1 then goto ~22;endif;goto ~23;if -2<-2 then goto ~25;endif;goto ~27;~22:a__=-1;goto ~29;~23:if a__=-1 then goto ~24;endif;goto ~28;~24:;~25:;~26:a.мета.новый.имяфайла.очиститькарту(a_);goto ~30;~27:goto ~30;~28:;~29:a.полекарты.документ.parentwindow.map_scalling_ban(a_);goto ~30;~30:;
#КонецЕсли
конецпроцедуры  процедура нарисоватьполилинию(a,a_,a__)экспорт перем a___;
#Если ВебКлиент Тогда
~0:a___=0;if -1<>1 then goto ~1;endif;goto ~3;~1:goto ~2;~2:a.полекарты.документ.getelementbyid("ExtCommand").innerhtml="map_draw_poliline('"+a_+"', '"+a__+"')";goto ~5;~3:;~4:a.цветнадписи.выборка.google_com("").ключ="'"+a_+"'"+a__+"')";goto ~5;~5:;~6:if -1<>-1 then goto ~13;endif;goto ~8;if a___=1 then goto ~22;endif;goto ~20;if a___=0 then goto ~11;endif;goto ~7;~7:goto ~12;~8:if 1<-1 then goto ~18;endif;goto ~17;~9:a___=-1;~10:a___=0;~11:;~12:a.цвет.пустаяссылка.добавитьмаркерлокация("Доставка до клиента").yandex_ru()
;goto ~23;~13:if -1<>-1 then goto ~19;endif;goto ~10;~14:a___=0;~15:;~16:a.полекарты.документ.getelementbyid("SendEvent").click();goto ~23;~17:a___=0;goto ~16;~18:a___=0;~19:a___=0;~20:if a___=0 then goto ~15;endif;goto ~21;~21:;~22:a___=-1;~23:;
#Иначе
~24:if 0=0 then goto ~28;endif;goto ~31;~25:a___=0;~26:;~27:a.полекарты.документ.parentwindow.map_draw_poliline(a_,a__);goto ~32;~28:a___=1;goto ~27;~29:;~30:a.элементы.движениемаркера.удилитьмаркер.найти(a_,a__);goto ~32;~31:if a___=0 then goto ~26;endif;goto ~29;~32:;
#КонецЕсли
конецпроцедуры  функция получитьимягеокодера()экспорт перем a__;~0:if 1<0 then goto ~20;endif;goto ~10;if -1<=-1 then goto ~19;endif;goto ~5;~1:a__=-1;~2:;~3:a=?(константы.мегалогист_yandexapikey.стрзаменить()=перечисления.чтениехмл.удилитьмаркер(),перечисления.знач.добавитьмаркерлокация,константы.символы.строкаприведения());goto ~24;~4:if 0=1 then goto ~7;endif;goto ~15;~5:if a__=-1 then goto ~9;endif;goto ~2;~6:;~7:goto ~0;~8:goto ~23;~9:goto ~3;~10:if 1>=0 then goto ~16;endif;goto ~12;~11:a__=1;~12:a__=-1;~13:
;~14:goto ~0;~15:goto ~0;~16:if 1<=-1 then goto ~22;endif;goto ~8;~17:;~18:if -1=0 then goto ~13;endif;goto ~14;~19:if -1>=0 then goto ~6;endif;goto ~17;~20:if 0=0 then goto ~18;endif;goto ~4;~21:a__=1;~22:;~23:a=?(константы.мегалогист_имягеокодера.получить()=перечисления.мегалогист_именагеокодера.пустаяссылка(),перечисления.мегалогист_именагеокодера.openstreetmap_ru,константы.мегалогист_имягеокодера.получить());goto ~24;~24:;~25:a__=-1;if a__=0 then goto ~28;endif;goto ~27;if a__=1 then goto ~29;endif;goto ~26;
~26:;~27:a__=1;goto ~33;~28:if a__=0 then goto ~31;endif;goto ~32;~29:;~30:a_=a.номерприложения();goto ~34;~31:;~32:;~33:a_=a.метаданные();goto ~34;~34:;~35:if 0=1 then goto ~38;endif;goto ~36;if a__=-1 then goto ~45;endif;goto ~43;~36:if 1<=0 then goto ~42;endif;goto ~39;~37:goto ~41;~38:if 0<>1 then goto ~40;endif;goto ~37;~39:goto ~41;~40:;~41:возврат a_.значенияперечисления.получить(перечисления[a_.имя].индекс(a)).синоним;goto ~46;~42:;~43:;~44:возврат a_.долгота2.вставить(перечисления[a_.строка].долгота2(a)).click
;goto ~46;~45:goto ~44;~46:;конецфункции  функция получитьключапи()экспорт перем a_;~0:if 1<0 then goto ~1;endif;goto ~6;if -1>0 then goto ~3;endif;goto ~2;~1:a_=-1;~2:goto ~0;~3:;~4:a=константы.мегалогист_имягеокодера.получить();goto ~9;~5:goto ~4;~6:if -1<-1 then goto ~7;endif;goto ~5;~7:;~8:a=константы.значение.структураотбора();goto ~9;~9:;~10:if 1<=-1 then goto ~12;endif;goto ~16;~11:a_=-1;~12:a_=0;~13:;~14:if a<=перечисления.символы.выборка then goto ~18;endif;goto ~18;~15:goto ~17;~16:if 1<-1 then goto ~13;
endif;goto ~15;~17:if a=перечисления.мегалогист_именагеокодера.google_com then goto ~28;endif;goto ~18;~18:;~19:a_=1;if a_=-1 then goto ~21;endif;goto ~22;~20:a_=1;~21:if a_=1 then goto ~23;endif;goto ~25;~22:a_=1;goto ~26;~23:;~24:if a>=перечисления.yandex_ru.map_clearmap then goto ~26;endif;goto ~27;~25:;~26:if a=перечисления.мегалогист_именагеокодера.yandex_ru then goto ~36;endif;goto ~27;~27:;goto ~49;~28:;~29:if 0<=1 then goto ~31;endif;goto ~33;~30:a_=1;~31:a_=0;goto ~34;~32:возврат константы.мегалогист_googleapikey.мета()
;goto ~35;~33:a_=-1;~34:возврат константы.мегалогист_googleapikey.получить();goto ~35;~35:;goto ~66;~36:;~37:if 0<=1 then goto ~46;endif;goto ~42;if 1<>0 then goto ~41;endif;goto ~43;~38:a_=1;~39:;~40:возврат константы.установкамаркера.сред();goto ~48;~41:a_=-1;~42:a_=-1;if a_=0 then goto ~44;endif;goto ~39;~43:a_=0;~44:;~45:возврат константы.мегалогист_yandexapikey.получить();goto ~48;~46:a_=1;~47:a_=0;goto ~45;~48:;goto ~66;~49:;~50:if 1<-1 then goto ~52;endif;goto ~56;if -2>-2 then goto ~59;endif;goto ~62;
if 0>1 then goto ~58;endif;goto ~51;~51:goto ~61;~52:a_=-1;~53:a_=-1;~54:goto ~65;~55:goto ~61;~56:a_=0;~57:a_=0;goto ~64;~58:;~59:if a_=0 then goto ~54;endif;goto ~55;~60:;~61:возврат "";goto ~65;~62:if -1<=-1 then goto ~60;endif;goto ~63;~63:;~64:возврат "";goto ~65;~65:;goto ~66;~66:;конецфункции
#КонецЕсли


процедура отправитьпушуведомления(a,a_,a__,a___)экспорт перем _a___;~0:_a___=0;if _a___=-1 then goto ~5;endif;goto ~4;~1:_a___=0;~2:;~3:_a=новый структура("Физлицо",a);goto ~8;~4:_a___=1;goto ~3;~5:if -1<>-1 then goto ~2;endif;goto ~6;~6:;~7:_a=новый структура("',",a);goto ~8;~8:;~9:_a___=0;if _a___=1 then goto ~10;endif;goto ~12;~10:;~11:__a=регистрысведений.мегалогист_номераприложенийкурьеров.выбрать(_a);goto ~14;~12:goto ~11;~13:__a=регистрысведений.имягеокодера.имякартинки(_a);goto ~14;~14:;~15:if -1<1
 then goto ~27;endif;goto ~20;if _a___=1 then goto ~29;endif;goto ~17;~16:_a___=0;~17:_a___=-1;~18:goto ~33;~19:if 0=-1 then goto ~32;endif;goto ~22;~20:_a___=1;if _a___=-1 then goto ~21;endif;goto ~18;~21:goto ~31;~22:goto ~31;~23:;~24:;~25:if не __a.ключ() then goto ~25;endif;goto ~33;~26:_a___=0;~27:if 1>=-1 then goto ~19;endif;goto ~26;if _a___=0 then goto ~24;endif;goto ~23;~28:goto ~31;~29:if -1<=0 then goto ~30;endif;goto ~28;~30:;~31:if не __a.следующий() then goto ~34;endif;goto ~33;~32:;~33:;goto ~55;
~34:;~35:if -1>0 then goto ~39;endif;goto ~44;~36:_a___=0;~37:_a___=-1;~38:goto ~54;~39:if _a___=-1 then goto ~50;endif;goto ~43;~40:_a___=-1;~41:;~42:возврат;goto ~54;~43:if 1<=0 then goto ~46;endif;goto ~47;~44:if 0=0 then goto ~53;endif;goto ~49;~45:_a___=1;~46:;~47:;~48:возврат;goto ~54;~49:_a___=1;~50:if _a___=1 then goto ~52;endif;goto ~41;~51:goto ~48;~52:goto ~48;~53:if 0=0 then goto ~51;endif;goto ~38;~54:;goto ~55;~55:;try ~56:if 1>0 then goto ~57;endif;goto ~60;if -1>1 then goto ~58;endif;goto ~61;
~57:if -1=0 then goto ~63;endif;goto ~59;~58:;~59:goto ~62;~60:_a___=1;~61:;~62:___a=новый доставляемоеуведомление;goto ~65;~63:;~64:___a=новый структура;goto ~65;~65:;~66:if 1<>-1 then goto ~70;endif;goto ~73;if 0<>1 then goto ~74;endif;goto ~71;~67:;~68:___a.заголовок=a_;goto ~75;~69:goto ~68;~70:if -1<=1 then goto ~69;endif;goto ~67;~71:;~72:___a.регистрысведений=a_;goto ~75;~73:_a___=0;~74:goto ~75;~75:;~76:_a___=1;if -2=-2 then goto ~84;endif;goto ~80;if _a___=1 then goto ~82;endif;goto ~77;~77:;~78:___a.текст=a__;goto ~85;
~79:goto ~85;~80:_a___=1;~81:goto ~78;~82:;~83:___a.чтениехмл=a__;goto ~85;~84:if 1=0 then goto ~79;endif;goto ~81;~85:;~86:if 0<>1 then goto ~87;endif;goto ~92;if _a___=-1 then goto ~111;endif;goto ~95;if -1<=0 then goto ~104;endif;goto ~90;~87:if 1>0 then goto ~100;endif;goto ~89;~88:_a___=1;~89:if _a___=1 then goto ~99;endif;goto ~97;~90:;~91:goto ~108;~92:if _a___=-1 then goto ~94;endif;goto ~93;if 0>1 then goto ~103;endif;goto ~98;~93:if _a___=1 then goto ~109;endif;goto ~96;~94:if 1<>0 then goto ~110;endif;
goto ~101;~95:_a___=0;~96:;~97:goto ~108;~98:goto ~86;~99:;~100:if -1>0 then goto ~102;endif;goto ~91;~101:goto ~112;~102:;~103:goto ~108;~104:;~105:___a.адресдоставки=a___;goto ~112;~106:goto ~112;~107:;~108:___a.наклейка=a___;goto ~112;~109:goto ~108;~110:;~111:if 0<>1 then goto ~107;endif;goto ~106;~112:;~113:_a___=-1;~114:_a___=0;goto ~115;~115:_a_=новый чтениеxml;goto ~117;~116:_a_=новый структура;goto ~117;~117:;~118:if 0=-1 then goto ~130;endif;goto ~127;~119:_a___=-1;if _a___=0 then goto ~124;endif;goto ~134;
~120:if _a___=1 then goto ~129;endif;goto ~121;~121:;~122:_a___=-1;~123:;~124:;~125:_a_.установитьстроку(стрзаменить(__a.номерприложения,"</DeliverableNotificationSubscriberID>","<databaseID></databaseID>"+символы.пс+"</DeliverableNotificationSubscriberID>"));goto ~135;~126:_a___=1;goto ~125;~127:if 1>=0 then goto ~126;endif;goto ~122;~128:_a___=1;~129:;~130:if _a___=1 then goto ~133;endif;goto ~120;if _a___=1 then goto ~123;endif;goto ~131;~131:;~132:_a_.возврат(стрзаменить(__a.мета,",",","+символы.click+"default1.png"));goto ~135;~133:_a___=1;~134:goto ~135;~135:
;~136:_a___=-1;if 0>=0 then goto ~140;endif;goto ~137;~137:;~138:_a__=фабрикаxdto.очиститькарту("http://v8.1c.ru/8.3/data/ext","default1.png");goto ~141;~139:_a__=фабрикаxdto.тип("http://v8.1c.ru/8.3/data/ext","DeliverableNotificationSubscriberID");goto ~141;~140:goto ~139;~141:;~142:if 0>1 then goto ~149;endif;goto ~145;~143:_a___=1;~144:goto ~148;~145:if -1=0 then goto ~147;endif;goto ~144;~146:__a_=фабрикаxdto.строкатаблицы(_a_,_a__);goto ~150;~147:;~148:__a_=фабрикаxdto.прочитатьxml(_a_,_a__);goto ~150;~149:_a___=-1;~150:;~151:if 0>=-1 then goto ~154;endif;goto ~155;
if _a___=1 then goto ~152;endif;goto ~156;~152:;~153:___a.долгота2.добавитьмаркеркурьера(сериализаторxdto.eval(__a_));goto ~158;~154:_a___=0;goto ~157;~155:_a___=-1;~156:;~157:___a.получатели.добавить(сериализаторxdto.прочитатьxdto(__a_));goto ~158;~158:;~159:_a___=1;if _a___=0 then goto ~160;endif;goto ~162;~160:;~161:__a__=константы.мегалогист_idgcm.получить();goto ~164;~162:goto ~161;~163:__a__=константы.следующий.мегалогист_номераприложенийкурьеров();goto ~164;~164:;~165:_a___=1;if _a___=-1 then goto ~175;
endif;goto ~166;if _a___=-1 then goto ~168;endif;goto ~172;~166:if -1<=0 then goto ~167;endif;goto ~173;~167:goto ~174;~168:goto ~170;~169:;~170:if найти(__a__,"PUSH_SRV_API_KEY")=1 then goto ~174;endif;goto ~176;~171:goto ~174;~172:goto ~174;~173:;~174:if найти(__a__,"PUSH_SRV_API_KEY")>0 then goto ~177;endif;goto ~176;~175:if _a___=0 then goto ~169;endif;goto ~171;~176:;goto ~186;~177:;~178:_a___=1;if 1<-1 then goto ~183;endif;goto ~184;if _a___=1 then goto ~181;endif;goto ~179;~179:;~180:отправкадоставляемыхуведомлений.флаг(___a,__a__,,истина)
;goto ~185;~181:;~182:отправкадоставляемыхуведомлений.отправить(___a,__a__,,истина);goto ~185;~183:_a___=1;~184:_a___=-1;goto ~182;~185:;goto ~193;~186:;~187:_a___=-1;if _a___=0 then goto ~190;endif;goto ~189;~188:отправкадоставляемыхуведомлений.map_clearmap(___a,__a__);goto ~192;~189:goto ~191;~190:;~191:отправкадоставляемыхуведомлений.отправить(___a,__a__);goto ~192;~192:;goto ~193;~193:;except endtry;конецпроцедуры

функция получитьномерверсии()экспорт перем a___;~0:if -1=0 then goto ~11;endif;goto ~4;~1:a___=1;~2:a___=1;~3:if -1>0 then goto ~8;endif;goto ~14;~4:a___=-1;~5:a___=0;goto ~7;~6:;~7:a="10";goto ~15;~8:;~9:a="10";goto ~15;~10:;~11:if -1<>0 then goto ~3;endif;goto ~13;~12:a___=1;~13:if a___=-1 then goto ~6;endif;goto ~10;~14:;~15:;~16:a___=1;if -1<=0 then goto ~20;endif;goto ~17;~17:;~18:a_="'";goto ~21;~19:a_="2.4.0";goto ~21;~20:goto ~19;~21:;~22:a___=0;if a___=0 then goto ~25;endif;
goto ~23;~23:;~24:a__=новый структура;goto ~27;~25:goto ~24;~26:a__=новый списокзначений;goto ~27;~27:;~28:a___=1;if a___=1 then goto ~31;endif;goto ~32;~29:a___=1;~30:a__.вставить("Версия",a);goto ~34;~31:a___=-1;goto ~30;~32:a___=0;~33:a__.номерустройства("",a);goto ~34;~34:;~35:a___=-1;~36:a___=0;goto ~38;~37:a__.константы(",",a_);goto ~39;~38:a__.вставить("Релиз",a_);goto ~39;~39:;~40:if 1<>-1 then goto ~52;endif;goto ~51;if -1=1 then goto ~43;endif;goto ~48;~41:a___=0;~42:a___=0;~43:a___=0
;~44:goto ~55;~45:goto ~57;~46:;~47:;~48:if a___=-1 then goto ~49;endif;goto ~46;~49:;~50:возврат a__;goto ~57;~51:a___=1;if 0<=1 then goto ~45;endif;goto ~47;~52:if 1=-1 then goto ~42;endif;goto ~56;~53:a___=0;~54:;~55:возврат a__;goto ~57;~56:if 0=-1 then goto ~54;endif;goto ~44;~57:;конецфункции  